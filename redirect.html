<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–ª–∞–¥–∫–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è...</title>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            flex-direction: column; /* –ò–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ column */
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            color: #333;
            padding: 20px;
            box-sizing: border-box;
        }
        .debug-info {
            background-color: #fff;
            border: 1px solid #ccc;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: left;
        }
        .debug-info p {
            margin: 8px 0;
        }
        .debug-info strong {
            color: #007bff;
        }
        .warning {
            color: orange;
            font-weight: bold;
        }
        .error {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="debug-info">
        <h1>–û—Ç–ª–∞–¥–∫–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="debug-status">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
        <p><strong>–ê–¥—Ä–µ—Å –∏–∑ localStorage:</strong> <span id="debug-address">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
        <p><strong>–ê–¥—Ä–µ—Å —Å–æ–¥–µ—Ä–∂–∏—Ç "—à–µ–ª–µ—Ö–æ–≤":</strong> <span id="debug-includes-shelekhov">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
        <p><strong>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π statusParam:</strong> <span id="debug-status-param">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
        <p><strong>–ü–æ–ª–Ω—ã–π URL –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ (–µ—Å–ª–∏ –±—ã –æ–Ω –±—ã–ª):</strong> <span id="debug-redirect-url">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
        <p class="warning">–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.</p>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('‚úÖ Custom script (GitHub Redirect Page - DEBUG): DOMContentLoaded fired.');

        // --- –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ó–ê–ú–ï–ù–ò–¢–ï –≠–¢–û–¢ URL –ù–ê –ê–î–†–ï–° –í–ê–®–ï–ô –ï–î–ò–ù–û–ô –°–¢–†–ê–ù–ò–¶–´ –ë–õ–ê–ì–û–î–ê–†–ù–û–°–¢–ò –í –¢–ò–õ–¨–î–ï ---
        const finalThankYouPageBaseUrl = 'https://gk38dev.tilda.ws/thx2'; 

        const debugStatusElem = document.getElementById('debug-status');
        const debugAddressElem = document.getElementById('debug-address');
        const debugIncludesShelekhovElem = document.getElementById('debug-includes-shelekhov');
        const debugStatusParamElem = document.getElementById('debug-status-param');
        const debugRedirectUrlElem = document.getElementById('debug-redirect-url');

        debugStatusElem.textContent = '–û–±—Ä–∞–±–æ—Ç–∫–∞...';

        const deliveryAddress = localStorage.getItem('deliveryAddress');
        console.log('üì¶ Custom script (GitHub Redirect Page - DEBUG): –ê–¥—Ä–µ—Å –ò–ó localStorage:', deliveryAddress);
        debugAddressElem.textContent = deliveryAddress || '–ù–ï –ù–ê–ô–î–ï–ù (null/–ø—É—Å—Ç–æ)';
        if (!deliveryAddress) {
            debugAddressElem.classList.add('error');
        }

        // –í—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ —É–¥–∞–ª—è–µ–º –∞–¥—Ä–µ—Å, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
        // localStorage.removeItem('deliveryAddress'); 
        // console.log('üßπ Custom script (GitHub Redirect Page - DEBUG): –ê–¥—Ä–µ—Å —É–¥–∞–ª–µ–Ω –ò–ó localStorage (–µ—Å–ª–∏ –±—ã–ª).');


        let statusParam = 'other'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
        let includesShelekhov = false;

        if (deliveryAddress) {
            const addressLower = deliveryAddress.toLowerCase();
            console.log('üì¶ Custom script (GitHub Redirect Page - DEBUG): –ê–¥—Ä–µ—Å –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ:', addressLower);
            includesShelekhov = addressLower.includes('—à–µ–ª–µ—Ö–æ–≤');
            console.log('üì¶ Custom script (GitHub Redirect Page - DEBUG): –ê–¥—Ä–µ—Å —Å–æ–¥–µ—Ä–∂–∏—Ç "—à–µ–ª–µ—Ö–æ–≤":', includesShelekhov);
            debugIncludesShelekhovElem.textContent = includesShelekhov ? '–î–∞' : '–ù–µ—Ç';

            if (includesShelekhov) {
                statusParam = 'shelekhov';
                console.log('‚û°Ô∏è Custom script (GitHub Redirect Page - DEBUG): –û–ø—Ä–µ–¥–µ–ª–µ–Ω —Å—Ç–∞—Ç—É—Å "shelekhov".');
            } else {
                console.log('‚û°Ô∏è Custom script (GitHub Redirect Page - DEBUG): –û–ø—Ä–µ–¥–µ–ª–µ–Ω —Å—Ç–∞—Ç—É—Å "other".');
            }
        } else {
            console.warn('‚ö†Ô∏è Custom script (GitHub Redirect Page - DEBUG): –ê–¥—Ä–µ—Å –ù–ï –ù–ê–ô–î–ï–ù –≤ localStorage. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å "other" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.');
            debugIncludesShelekhovElem.textContent = '–ù/–î (–Ω–µ—Ç –∞–¥—Ä–µ—Å–∞)';
        }

        debugStatusParamElem.textContent = statusParam;
        
        const generatedRedirectUrl = finalThankYouPageBaseUrl + '?status=' + statusParam;
        console.log('‚û°Ô∏è Custom script (GitHub Redirect Page - DEBUG): –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π URL –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:', generatedRedirectUrl);
        debugRedirectUrlElem.textContent = generatedRedirectUrl;
        
        debugStatusElem.textContent = '–ì–æ—Ç–æ–≤–æ –∫ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é (–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ)';

        // –ü–ï–†–ï–ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï –í–†–ï–ú–ï–ù–ù–û –û–¢–ö–õ–Æ–ß–ï–ù–û –î–õ–Ø –û–¢–õ–ê–î–ö–ò!
        // window.location.replace(generatedRedirectUrl);
    });
    </script>
</body>
</html>
